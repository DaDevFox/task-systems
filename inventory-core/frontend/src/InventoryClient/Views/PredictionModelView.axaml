<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:models="using:InventoryClient.Models"
             mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="450"
             x:Class="InventoryClient.Views.PredictionModelView"
             x:DataType="models:PredictionTrainingStatusViewModel">
  
  <UserControl.Styles>
    <Style Selector="TextBlock.heading">
      <Setter Property="FontWeight" Value="Bold"/>
      <Setter Property="FontSize" Value="16"/>
      <Setter Property="Margin" Value="0,0,0,10"/>
    </Style>
    
    <Style Selector="TextBlock.label">
      <Setter Property="FontWeight" Value="SemiBold"/>
      <Setter Property="Margin" Value="0,5,10,5"/>
      <Setter Property="VerticalAlignment" Value="Center"/>
    </Style>
    
    <Style Selector="ProgressBar.training">
      <Setter Property="Height" Value="20"/>
      <Setter Property="Margin" Value="0,5,0,10"/>
    </Style>
    
    <Style Selector="ComboBox.model-selector">
      <Setter Property="MinWidth" Value="150"/>
      <Setter Property="Margin" Value="0,5"/>
    </Style>
  </UserControl.Styles>

  <Border BorderBrush="{DynamicResource SystemControlForegroundBaseMediumBrush}" 
          BorderThickness="1" 
          CornerRadius="5" 
          Padding="15">
    
    <StackPanel Spacing="15">
      
      <!-- Header -->
      <Grid ColumnDefinitions="*,Auto">
        <TextBlock Grid.Column="0" 
                   Classes="heading" 
                   Text="Prediction Model Management"/>
        
        <StackPanel Grid.Column="1" 
                    Orientation="Horizontal" 
                    Spacing="10">
          <Button Content="Start Training" 
                  Name="StartTrainingButton"
                  Classes="accent"/>
          <Button Content="Refresh Status" 
                  Name="RefreshButton"/>
        </StackPanel>
      </Grid>

      <!-- Current Status Section -->
      <Expander Header="Current Status" IsExpanded="True">
        <Grid RowDefinitions="Auto,Auto,Auto,Auto,Auto" 
              ColumnDefinitions="Auto,*"
              Margin="10">
          
          <!-- Training Stage -->
          <TextBlock Grid.Row="0" Grid.Column="0" 
                     Classes="label" 
                     Text="Training Stage:"/>
          <TextBlock Grid.Row="0" Grid.Column="1" 
                     Text="{Binding StageDescription}" 
                     VerticalAlignment="Center"/>
          
          <!-- Active Model -->
          <TextBlock Grid.Row="1" Grid.Column="0" 
                     Classes="label" 
                     Text="Active Model:"/>
          <TextBlock Grid.Row="1" Grid.Column="1" 
                     Text="{Binding ActiveModel}" 
                     VerticalAlignment="Center"/>
          
          <!-- Training Progress -->
          <TextBlock Grid.Row="2" Grid.Column="0" 
                     Classes="label" 
                     Text="Training Progress:"/>
          <StackPanel Grid.Row="2" Grid.Column="1" 
                      Orientation="Vertical">
            <ProgressBar Classes="training" 
                         Value="{Binding TrainingProgress}" 
                         Maximum="1"/>
            <TextBlock Text="{Binding TrainingProgressText}" 
                       FontSize="12" 
                       Foreground="{DynamicResource SystemControlForegroundBaseMediumBrush}"/>
          </StackPanel>
          
          <!-- Accuracy -->
          <TextBlock Grid.Row="3" Grid.Column="0" 
                     Classes="label" 
                     Text="Model Accuracy:"/>
          <TextBlock Grid.Row="3" Grid.Column="1" 
                     Text="{Binding AccuracyDisplayText}" 
                     VerticalAlignment="Center"/>
          
          <!-- Last Updated -->
          <TextBlock Grid.Row="4" Grid.Column="0" 
                     Classes="label" 
                     Text="Last Updated:"/>
          <TextBlock Grid.Row="4" Grid.Column="1" 
                     Text="{Binding LastUpdated, StringFormat='yyyy-MM-dd HH:mm:ss'}" 
                     VerticalAlignment="Center"/>
        </Grid>
      </Expander>

      <!-- Model Selection Section -->
      <Expander Header="Model Configuration" IsExpanded="False">
        <StackPanel Margin="10" Spacing="10">
          
          <!-- Available Models -->
          <TextBlock Classes="label" Text="Available Models:"/>
          <ComboBox Name="ModelSelectionComboBox" 
                    Classes="model-selector"
                    ItemsSource="{Binding AvailableModels}"
                    SelectedItem="{Binding ActiveModel}">
            <ComboBox.ItemTemplate>
              <DataTemplate>
                <TextBlock Text="{Binding}"/>
              </DataTemplate>
            </ComboBox.ItemTemplate>
          </ComboBox>
          
          <!-- Model Parameters -->
          <TextBlock Classes="label" Text="Model Parameters:"/>
          <StackPanel Spacing="8">
            
            <!-- Confidence Threshold -->
            <Grid ColumnDefinitions="150,*" Margin="0,2">
              <TextBlock Grid.Column="0" 
                         Text="Confidence Threshold:" 
                         VerticalAlignment="Center"/>
              <NumericUpDown Grid.Column="1" 
                             Value="0.85" 
                             Increment="0.05" 
                             Minimum="0.1"
                             Maximum="1.0"
                             FormatString="F2"/>
            </Grid>
            
            <!-- Window Size -->
            <Grid ColumnDefinitions="150,*" Margin="0,2">
              <TextBlock Grid.Column="0" 
                         Text="Window Size:" 
                         VerticalAlignment="Center"/>
              <NumericUpDown Grid.Column="1" 
                             Value="7" 
                             Increment="1" 
                             Minimum="1"
                             Maximum="30"
                             FormatString="F0"/>
            </Grid>
            
            <!-- Learning Rate -->
            <Grid ColumnDefinitions="150,*" Margin="0,2">
              <TextBlock Grid.Column="0" 
                         Text="Learning Rate:" 
                         VerticalAlignment="Center"/>
              <NumericUpDown Grid.Column="1" 
                             Value="0.1" 
                             Increment="0.01" 
                             Minimum="0.001"
                             Maximum="1.0"
                             FormatString="F3"/>
            </Grid>
            
            <!-- Regularization -->
            <Grid ColumnDefinitions="150,*" Margin="0,2">
              <TextBlock Grid.Column="0" 
                         Text="Regularization:" 
                         VerticalAlignment="Center"/>
              <NumericUpDown Grid.Column="1" 
                             Value="0.01" 
                             Increment="0.001" 
                             Minimum="0.001"
                             Maximum="0.1"
                             FormatString="F3"/>
            </Grid>
            
          </StackPanel>
          
          <Button Content="Apply Configuration" 
                  Name="ApplyConfigButton" 
                  HorizontalAlignment="Left"/>
        </StackPanel>
      </Expander>

      <!-- Model Performance Section -->
      <Expander Header="Model Performance" IsExpanded="False">
        <StackPanel Margin="10" Spacing="10">
          
          <TextBlock Classes="label" Text="Performance Metrics:"/>
          
          <!-- Placeholder for performance charts/metrics -->
          <Border Background="{DynamicResource SystemControlBackgroundAltMediumBrush}" 
                  Height="150" 
                  CornerRadius="3">
            <TextBlock Text="Performance metrics will be displayed here" 
                       HorizontalAlignment="Center" 
                       VerticalAlignment="Center" 
                       Foreground="{DynamicResource SystemControlForegroundBaseMediumBrush}"/>
          </Border>
          
          <Button Content="View Detailed Analytics" 
                  Name="ViewAnalyticsButton" 
                  HorizontalAlignment="Left"/>
        </StackPanel>
      </Expander>

    </StackPanel>
  </Border>

</UserControl>
